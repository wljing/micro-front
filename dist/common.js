!function(I,g){if("object"==typeof exports&&"object"==typeof module)module.exports=g();else if("function"==typeof define&&define.amd)define([],g);else{var C=g();for(var Q in C)("object"==typeof exports?exports:I)[Q]=C[Q]}}(window,(function(){return function(I){var g={};function C(Q){if(g[Q])return g[Q].exports;var B=g[Q]={i:Q,l:!1,exports:{}};return I[Q].call(B.exports,B,B.exports,C),B.l=!0,B.exports}return C.m=I,C.c=g,C.d=function(I,g,Q){C.o(I,g)||Object.defineProperty(I,g,{enumerable:!0,get:Q})},C.r=function(I){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(I,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(I,"__esModule",{value:!0})},C.t=function(I,g){if(1&g&&(I=C(I)),8&g)return I;if(4&g&&"object"==typeof I&&I&&I.__esModule)return I;var Q=Object.create(null);if(C.r(Q),Object.defineProperty(Q,"default",{enumerable:!0,value:I}),2&g&&"string"!=typeof I)for(var B in I)C.d(Q,B,function(g){return I[g]}.bind(null,B));return Q},C.n=function(I){var g=I&&I.__esModule?function(){return I.default}:function(){return I};return C.d(g,"a",g),g},C.o=function(I,g){return Object.prototype.hasOwnProperty.call(I,g)},C.p="",C(C.s=1)}([function(module,exports,__webpack_require__){"use strict";eval("\n\nexports.__esModule = true;\nvar windoFunMap = new Map([['alert', true], ['atob', true], ['blur', true], ['btoa', true], ['cancelAnimateFrame', true], ['cancelIdleCallback', true], ['captrueEvents', true], ['clearInterval', true], ['clearTimeout', true], ['close', true], ['confirm', true], ['fetch', true], ['find', true], ['focus', true], ['getAttention', true], ['getComputedStyle', true], ['getDefaultComputedStyle', true], ['getSelection', true], ['setTimeout', true], ['setInterval', true], ['addEventListener', true], ['postMessage', true]]);\n\nvar JsSandBox = function () {\n  function JsSandBox() {\n    this.isShowLog = false;\n    this.init();\n  }\n\n  JsSandBox.defineGlobalProperty = function (key, value) {\n    JsSandBox.GlobalPropertyMap.set(key, value);\n  };\n\n  JsSandBox.prototype.init = function () {\n    this.propertiesMap = new Map();\n    this.unConfigurableMap = new Map();\n    this.initFakerWindow();\n    this.mountFakerWindow();\n  };\n\n  JsSandBox.prototype.run = function (script, cb) {\n    if (cb === void 0) {\n      cb = function cb() {};\n    }\n\n    var fn = new Function(\"\\n      with(window['\" + this.sandBoxName + \"']) {\\n        \" + script + \"\\n      }\\n    \");\n    fn();\n    cb();\n  };\n\n  JsSandBox.prototype.initFakerWindow = function () {\n    var unConfigurableMap = this.unConfigurableMap;\n    var descs = Object.getOwnPropertyDescriptors(window);\n    Object.keys(descs).forEach(function (p) {\n      if (!Reflect.getOwnPropertyDescriptor(window, p).configurable) {\n        unConfigurableMap.set(p, window[p]);\n      }\n    });\n    var self = this;\n    var unscopables = {\n      undefined: true,\n      Array: true,\n      Object: true,\n      String: true,\n      Boolean: true,\n      Math: true,\n      Number: true,\n      Symbol: true,\n      parseFloat: true,\n      Float32Array: true\n    };\n    this.fakerWindow = new Proxy(window, {\n      get: function get(target, p) {\n        var result = null;\n        var log = '';\n\n        if (p === 'window' || p === 'self' || p === 'top' || p === 'parent') {\n          result = self.fakerWindow;\n          log = 'global';\n        } else if (p === Symbol.unscopables) {\n          result = unscopables;\n          log = 'unscopables';\n        } else if (unConfigurableMap.has(p)) {\n          result = window[p];\n          log = 'unconfig';\n        } else if (JsSandBox.GlobalPropertyMap.has(p)) {\n          log = 'global';\n          result = JsSandBox.GlobalPropertyMap.get(p);\n        } else if (self.propertiesMap.has(p)) {\n          log = 'sendbox';\n          result = self.propertiesMap.get(p);\n        } else {\n          log = 'window';\n          result = window[p];\n\n          if (windoFunMap.has(p)) {\n            result = result.bind(window);\n          }\n        }\n\n        if (self.isShowLog) {\n          console.log('get', p, result, log);\n        }\n\n        return result;\n      },\n      set: function set(target, p, v) {\n        var log = '';\n\n        if (self.unConfigurableMap.has(p)) {\n          log = 'unconfig';\n          return false;\n        } else if (JsSandBox.GlobalPropertyMap.has(p)) {\n          JsSandBox.GlobalPropertyMap.set(p, v);\n          log = 'global';\n        } else {\n          log = 'sendbox';\n          self.propertiesMap.set(p, v);\n\n          if (!Reflect.has(window, p)) {\n            window[p] = v;\n          }\n        }\n\n        if (self.isShowLog) {\n          console.log('set', p, v, log);\n        }\n\n        return true;\n      }\n    });\n  };\n\n  JsSandBox.prototype.mountFakerWindow = function () {\n    var sandBoxName = \"\" + JsSandBox.PreSandBoxName + JsSandBox.JsSandBoxIndex++;\n    this.sandBoxName = sandBoxName;\n    var fakerWindow = this.fakerWindow;\n    Reflect.defineProperty(window, sandBoxName, {\n      value: fakerWindow,\n      configurable: false,\n      enumerable: false,\n      writable: false\n    });\n  };\n\n  JsSandBox.JsSandBoxIndex = 0;\n  JsSandBox.PreSandBoxName = '__JS_SAND_BOX_';\n  JsSandBox.GlobalPropertyMap = new Map();\n  return JsSandBox;\n}();\n\nexports[\"default\"] = JsSandBox;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VCxFQUFvQjtBQUNsQixpQkFBTyxDQUFDLEdBQVIsQ0FBWSxLQUFaLEVBQW1CLENBQW5CLEVBQXNCLENBQXRCLEVBQXlCLEdBQXpCO0FBQ0Q7O0FBQ0QsZUFBTyxJQUFQO0FBQ0Q7QUF6RGtDLEtBQWxCLENBQW5CO0FBMkRELEdBaEZPOztBQW1GQSx5Q0FBUjtBQUNFLFFBQU0sV0FBVyxHQUFHLEtBQUcsU0FBUyxDQUFDLGNBQWIsR0FBOEIsU0FBUyxDQUFDLGNBQVYsRUFBbEQ7QUFDQSxTQUFLLFdBQUwsR0FBbUIsV0FBbkI7QUFDQSxRQUFNLFdBQVcsR0FBRyxLQUFLLFdBQXpCO0FBQ0EsV0FBTyxDQUFDLGNBQVIsQ0FBdUIsTUFBdkIsRUFBK0IsV0FBL0IsRUFBNEM7QUFDMUMsV0FBSyxFQUFFLFdBRG1DO0FBRTFDLGtCQUFZLEVBQUUsS0FGNEI7QUFHMUMsZ0JBQVUsRUFBRSxLQUg4QjtBQUkxQyxjQUFRLEVBQUU7QUFKZ0MsS0FBNUM7QUFNRCxHQVZPOztBQXZITyw2QkFBeUIsQ0FBekI7QUFDQSw2QkFBaUIsZ0JBQWpCO0FBQ0EsZ0NBQW9CLElBQUksR0FBSixFQUFwQjtBQWdJakI7QUFBQyxDQW5JRDs7cUJBQXFCLFMiLCJmaWxlIjoiMC5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xyXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xyXG52YXIgd2luZG9GdW5NYXAgPSBuZXcgTWFwKFtcclxuICAgIFsnYWxlcnQnLCB0cnVlXSxcclxuICAgIFsnYXRvYicsIHRydWVdLFxyXG4gICAgWydibHVyJywgdHJ1ZV0sXHJcbiAgICBbJ2J0b2EnLCB0cnVlXSxcclxuICAgIFsnY2FuY2VsQW5pbWF0ZUZyYW1lJywgdHJ1ZV0sXHJcbiAgICBbJ2NhbmNlbElkbGVDYWxsYmFjaycsIHRydWVdLFxyXG4gICAgWydjYXB0cnVlRXZlbnRzJywgdHJ1ZV0sXHJcbiAgICBbJ2NsZWFySW50ZXJ2YWwnLCB0cnVlXSxcclxuICAgIFsnY2xlYXJUaW1lb3V0JywgdHJ1ZV0sXHJcbiAgICBbJ2Nsb3NlJywgdHJ1ZV0sXHJcbiAgICBbJ2NvbmZpcm0nLCB0cnVlXSxcclxuICAgIFsnZmV0Y2gnLCB0cnVlXSxcclxuICAgIFsnZmluZCcsIHRydWVdLFxyXG4gICAgWydmb2N1cycsIHRydWVdLFxyXG4gICAgWydnZXRBdHRlbnRpb24nLCB0cnVlXSxcclxuICAgIFsnZ2V0Q29tcHV0ZWRTdHlsZScsIHRydWVdLFxyXG4gICAgWydnZXREZWZhdWx0Q29tcHV0ZWRTdHlsZScsIHRydWVdLFxyXG4gICAgWydnZXRTZWxlY3Rpb24nLCB0cnVlXSxcclxuICAgIFsnc2V0VGltZW91dCcsIHRydWVdLFxyXG4gICAgWydzZXRJbnRlcnZhbCcsIHRydWVdLFxyXG4gICAgWydhZGRFdmVudExpc3RlbmVyJywgdHJ1ZV0sXHJcbiAgICBbJ3Bvc3RNZXNzYWdlJywgdHJ1ZV0sXHJcbl0pO1xyXG52YXIgSnNTYW5kQm94ID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEpzU2FuZEJveCgpIHtcclxuICAgICAgICB0aGlzLmlzU2hvd0xvZyA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuaW5pdCgpO1xyXG4gICAgfVxyXG4gICAgSnNTYW5kQm94LmRlZmluZUdsb2JhbFByb3BlcnR5ID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcclxuICAgICAgICBKc1NhbmRCb3guR2xvYmFsUHJvcGVydHlNYXAuc2V0KGtleSwgdmFsdWUpO1xyXG4gICAgfTtcclxuICAgIEpzU2FuZEJveC5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnByb3BlcnRpZXNNYXAgPSBuZXcgTWFwKCk7XHJcbiAgICAgICAgdGhpcy51bkNvbmZpZ3VyYWJsZU1hcCA9IG5ldyBNYXAoKTtcclxuICAgICAgICB0aGlzLmluaXRGYWtlcldpbmRvdygpO1xyXG4gICAgICAgIHRoaXMubW91bnRGYWtlcldpbmRvdygpO1xyXG4gICAgfTtcclxuICAgIEpzU2FuZEJveC5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKHNjcmlwdCwgY2IpIHtcclxuICAgICAgICBpZiAoY2IgPT09IHZvaWQgMCkgeyBjYiA9IGZ1bmN0aW9uICgpIHsgfTsgfVxyXG4gICAgICAgIHZhciBmbiA9IG5ldyBGdW5jdGlvbihcIlxcbiAgICAgIHdpdGgod2luZG93WydcIiArIHRoaXMuc2FuZEJveE5hbWUgKyBcIiddKSB7XFxuICAgICAgICBcIiArIHNjcmlwdCArIFwiXFxuICAgICAgfVxcbiAgICBcIik7XHJcbiAgICAgICAgZm4oKTtcclxuICAgICAgICBjYigpO1xyXG4gICAgfTtcclxuICAgIEpzU2FuZEJveC5wcm90b3R5cGUuaW5pdEZha2VyV2luZG93ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciB1bkNvbmZpZ3VyYWJsZU1hcCA9IHRoaXMudW5Db25maWd1cmFibGVNYXA7XHJcbiAgICAgICAgdmFyIGRlc2NzID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMod2luZG93KTtcclxuICAgICAgICBPYmplY3Qua2V5cyhkZXNjcykuZm9yRWFjaChmdW5jdGlvbiAocCkge1xyXG4gICAgICAgICAgICBpZiAoIVJlZmxlY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHdpbmRvdywgcCkuY29uZmlndXJhYmxlKSB7XHJcbiAgICAgICAgICAgICAgICB1bkNvbmZpZ3VyYWJsZU1hcC5zZXQocCwgd2luZG93W3BdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB2YXIgdW5zY29wYWJsZXMgPSB7XHJcbiAgICAgICAgICAgIHVuZGVmaW5lZDogdHJ1ZSxcclxuICAgICAgICAgICAgQXJyYXk6IHRydWUsXHJcbiAgICAgICAgICAgIE9iamVjdDogdHJ1ZSxcclxuICAgICAgICAgICAgU3RyaW5nOiB0cnVlLFxyXG4gICAgICAgICAgICBCb29sZWFuOiB0cnVlLFxyXG4gICAgICAgICAgICBNYXRoOiB0cnVlLFxyXG4gICAgICAgICAgICBOdW1iZXI6IHRydWUsXHJcbiAgICAgICAgICAgIFN5bWJvbDogdHJ1ZSxcclxuICAgICAgICAgICAgcGFyc2VGbG9hdDogdHJ1ZSxcclxuICAgICAgICAgICAgRmxvYXQzMkFycmF5OiB0cnVlXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmZha2VyV2luZG93ID0gbmV3IFByb3h5KHdpbmRvdywge1xyXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICh0YXJnZXQsIHApIHtcclxuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgdmFyIGxvZyA9ICcnO1xyXG4gICAgICAgICAgICAgICAgaWYgKHAgPT09ICd3aW5kb3cnIHx8IHAgPT09ICdzZWxmJyB8fCBwID09PSAndG9wJyB8fCBwID09PSAncGFyZW50Jykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHNlbGYuZmFrZXJXaW5kb3c7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9nID0gJ2dsb2JhbCc7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChwID09PSBTeW1ib2wudW5zY29wYWJsZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB1bnNjb3BhYmxlcztcclxuICAgICAgICAgICAgICAgICAgICBsb2cgPSAndW5zY29wYWJsZXMnO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodW5Db25maWd1cmFibGVNYXAuaGFzKHApKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gd2luZG93W3BdO1xyXG4gICAgICAgICAgICAgICAgICAgIGxvZyA9ICd1bmNvbmZpZyc7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChKc1NhbmRCb3guR2xvYmFsUHJvcGVydHlNYXAuaGFzKHApKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9nID0gJ2dsb2JhbCc7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gSnNTYW5kQm94Lkdsb2JhbFByb3BlcnR5TWFwLmdldChwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHNlbGYucHJvcGVydGllc01hcC5oYXMocCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBsb2cgPSAnc2VuZGJveCc7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gc2VsZi5wcm9wZXJ0aWVzTWFwLmdldChwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGxvZyA9ICd3aW5kb3cnO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHdpbmRvd1twXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAod2luZG9GdW5NYXAuaGFzKHApKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdC5iaW5kKHdpbmRvdyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuaXNTaG93TG9nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2dldCcsIHAsIHJlc3VsdCwgbG9nKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gKHRhcmdldCwgcCwgdikge1xyXG4gICAgICAgICAgICAgICAgdmFyIGxvZyA9ICcnO1xyXG4gICAgICAgICAgICAgICAgaWYgKHNlbGYudW5Db25maWd1cmFibGVNYXAuaGFzKHApKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9nID0gJ3VuY29uZmlnJztcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChKc1NhbmRCb3guR2xvYmFsUHJvcGVydHlNYXAuaGFzKHApKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgSnNTYW5kQm94Lkdsb2JhbFByb3BlcnR5TWFwLnNldChwLCB2KTtcclxuICAgICAgICAgICAgICAgICAgICBsb2cgPSAnZ2xvYmFsJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGxvZyA9ICdzZW5kYm94JztcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLnByb3BlcnRpZXNNYXAuc2V0KHAsIHYpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghUmVmbGVjdC5oYXMod2luZG93LCBwKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3dbcF0gPSB2O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChzZWxmLmlzU2hvd0xvZykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzZXQnLCBwLCB2LCBsb2cpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBKc1NhbmRCb3gucHJvdG90eXBlLm1vdW50RmFrZXJXaW5kb3cgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHNhbmRCb3hOYW1lID0gXCJcIiArIEpzU2FuZEJveC5QcmVTYW5kQm94TmFtZSArIEpzU2FuZEJveC5Kc1NhbmRCb3hJbmRleCsrO1xyXG4gICAgICAgIHRoaXMuc2FuZEJveE5hbWUgPSBzYW5kQm94TmFtZTtcclxuICAgICAgICB2YXIgZmFrZXJXaW5kb3cgPSB0aGlzLmZha2VyV2luZG93O1xyXG4gICAgICAgIFJlZmxlY3QuZGVmaW5lUHJvcGVydHkod2luZG93LCBzYW5kQm94TmFtZSwge1xyXG4gICAgICAgICAgICB2YWx1ZTogZmFrZXJXaW5kb3csXHJcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2UsXHJcbiAgICAgICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICAgICAgICB3cml0YWJsZTogZmFsc2VcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBKc1NhbmRCb3guSnNTYW5kQm94SW5kZXggPSAwO1xyXG4gICAgSnNTYW5kQm94LlByZVNhbmRCb3hOYW1lID0gJ19fSlNfU0FORF9CT1hfJztcclxuICAgIEpzU2FuZEJveC5HbG9iYWxQcm9wZXJ0eU1hcCA9IG5ldyBNYXAoKTtcclxuICAgIHJldHVybiBKc1NhbmRCb3g7XHJcbn0oKSk7XHJcbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gSnNTYW5kQm94O1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///0\n")},function(module,exports,__webpack_require__){eval("module.exports = __webpack_require__(2);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguanM/YjYzNSJdLCJuYW1lcyI6WyJtb2R1bGUiLCJleHBvcnRzIiwicmVxdWlyZSJdLCJtYXBwaW5ncyI6IkFBQUFBLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQkMsbUJBQU8sQ0FBQyxDQUFELENBQXhCIiwiZmlsZSI6IjEuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCIuL0FwcE1hbm5nZXJcIik7Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///1\n")},function(module,exports,__webpack_require__){"use strict";eval('\n\nexports.__esModule = true;\n\nvar JsSandBox_1 = __webpack_require__(0);\n\nvar index_1 = __webpack_require__(3);\n\nvar Communicator_1 = __webpack_require__(4);\n\nJsSandBox_1["default"].defineGlobalProperty(\'IPC\', new Communicator_1["default"]());\n\nvar AppMannger = function () {\n  function AppMannger(config) {\n    var _this = this;\n\n    this.getAppId = function () {\n      return "AppId_" + AppMannger.APP_INDEX++;\n    };\n\n    this.init = function () {\n      var apps = _this.config.apps;\n      apps.forEach(function (appConfig) {\n        _this.add(appConfig);\n      });\n    };\n\n    this.load = function (appId, parent, force) {\n      if (force === void 0) {\n        force = false;\n      }\n\n      if (typeof appId === \'number\') {\n        appId = _this.appList[appId].appId;\n      }\n\n      if (_this.appStatusMap.has(appId)) {\n        var appStatus = _this.appStatusMap.get(appId);\n\n        console.log(appStatus);\n\n        if (!appStatus.active || force) {\n          console.log(\'parnet\', parent, parent instanceof HTMLElement);\n\n          if (parent instanceof HTMLElement) {\n            appStatus.appConfig.parent = parent;\n          }\n\n          var loader = new index_1["default"](appStatus.appConfig);\n          loader.load();\n          appStatus.loader = loader;\n          appStatus.active = true;\n        }\n      } else {\n        console.error("app is not init which appId is " + appId);\n      }\n    };\n\n    this.reLoad = function (appId) {\n      _this.load(appId, null, true);\n    };\n\n    this.add = function (appConfig) {\n      var appStatus = {\n        loader: null,\n        active: false,\n        appId: appConfig.id || _this.getAppId(),\n        appConfig: appConfig\n      };\n\n      _this.appStatusMap.set(appStatus.appId, appStatus);\n\n      _this.appList.push(appStatus);\n    };\n\n    this.del = function (appId) {\n      _this.appList = _this.appList.filter(function (v) {\n        return v.appId === appId;\n      });\n\n      _this.appStatusMap["delete"](appId);\n    };\n\n    this.config = config;\n    this.appList = [];\n    this.appStatusMap = new Map();\n    this.init();\n  }\n\n  AppMannger.APP_INDEX = 0;\n  return AppMannger;\n}();\n\nexports["default"] = AppMannger;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QkFBb0IsQ0FBcEI7QUErRFQ7QUFBQyxDQWhFRDs7cUJBQXFCLFUiLCJmaWxlIjoiMi5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xyXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xyXG52YXIgSnNTYW5kQm94XzEgPSByZXF1aXJlKFwiLi4vSnNTYW5kQm94XCIpO1xyXG52YXIgaW5kZXhfMSA9IHJlcXVpcmUoXCIuLi9BcHBMb2FkZXIvaW5kZXhcIik7XHJcbnZhciBDb21tdW5pY2F0b3JfMSA9IHJlcXVpcmUoXCIuLi9Db21tdW5pY2F0b3JcIik7XHJcbkpzU2FuZEJveF8xW1wiZGVmYXVsdFwiXS5kZWZpbmVHbG9iYWxQcm9wZXJ0eSgnSVBDJywgbmV3IENvbW11bmljYXRvcl8xW1wiZGVmYXVsdFwiXSgpKTtcclxudmFyIEFwcE1hbm5nZXIgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQXBwTWFubmdlcihjb25maWcpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuZ2V0QXBwSWQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBcIkFwcElkX1wiICsgQXBwTWFubmdlci5BUFBfSU5ERVgrKzsgfTtcclxuICAgICAgICB0aGlzLmluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBhcHBzID0gX3RoaXMuY29uZmlnLmFwcHM7XHJcbiAgICAgICAgICAgIGFwcHMuZm9yRWFjaChmdW5jdGlvbiAoYXBwQ29uZmlnKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5hZGQoYXBwQ29uZmlnKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmxvYWQgPSBmdW5jdGlvbiAoYXBwSWQsIHBhcmVudCwgZm9yY2UpIHtcclxuICAgICAgICAgICAgaWYgKGZvcmNlID09PSB2b2lkIDApIHsgZm9yY2UgPSBmYWxzZTsgfVxyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGFwcElkID09PSAnbnVtYmVyJykge1xyXG4gICAgICAgICAgICAgICAgYXBwSWQgPSBfdGhpcy5hcHBMaXN0W2FwcElkXS5hcHBJZDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoX3RoaXMuYXBwU3RhdHVzTWFwLmhhcyhhcHBJZCkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBhcHBTdGF0dXMgPSBfdGhpcy5hcHBTdGF0dXNNYXAuZ2V0KGFwcElkKTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGFwcFN0YXR1cyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWFwcFN0YXR1cy5hY3RpdmUgfHwgZm9yY2UpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncGFybmV0JywgcGFyZW50LCBwYXJlbnQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmVudCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFwcFN0YXR1cy5hcHBDb25maWcucGFyZW50ID0gcGFyZW50O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB2YXIgbG9hZGVyID0gbmV3IGluZGV4XzFbXCJkZWZhdWx0XCJdKGFwcFN0YXR1cy5hcHBDb25maWcpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxvYWRlci5sb2FkKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYXBwU3RhdHVzLmxvYWRlciA9IGxvYWRlcjtcclxuICAgICAgICAgICAgICAgICAgICBhcHBTdGF0dXMuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJhcHAgaXMgbm90IGluaXQgd2hpY2ggYXBwSWQgaXMgXCIgKyBhcHBJZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMucmVMb2FkID0gZnVuY3Rpb24gKGFwcElkKSB7XHJcbiAgICAgICAgICAgIF90aGlzLmxvYWQoYXBwSWQsIG51bGwsIHRydWUpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5hZGQgPSBmdW5jdGlvbiAoYXBwQ29uZmlnKSB7XHJcbiAgICAgICAgICAgIHZhciBhcHBTdGF0dXMgPSB7XHJcbiAgICAgICAgICAgICAgICBsb2FkZXI6IG51bGwsXHJcbiAgICAgICAgICAgICAgICBhY3RpdmU6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgYXBwSWQ6IGFwcENvbmZpZy5pZCB8fCBfdGhpcy5nZXRBcHBJZCgpLFxyXG4gICAgICAgICAgICAgICAgYXBwQ29uZmlnOiBhcHBDb25maWdcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgX3RoaXMuYXBwU3RhdHVzTWFwLnNldChhcHBTdGF0dXMuYXBwSWQsIGFwcFN0YXR1cyk7XHJcbiAgICAgICAgICAgIF90aGlzLmFwcExpc3QucHVzaChhcHBTdGF0dXMpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5kZWwgPSBmdW5jdGlvbiAoYXBwSWQpIHtcclxuICAgICAgICAgICAgX3RoaXMuYXBwTGlzdCA9IF90aGlzLmFwcExpc3QuZmlsdGVyKGZ1bmN0aW9uICh2KSB7IHJldHVybiB2LmFwcElkID09PSBhcHBJZDsgfSk7XHJcbiAgICAgICAgICAgIF90aGlzLmFwcFN0YXR1c01hcFtcImRlbGV0ZVwiXShhcHBJZCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZztcclxuICAgICAgICB0aGlzLmFwcExpc3QgPSBbXTtcclxuICAgICAgICB0aGlzLmFwcFN0YXR1c01hcCA9IG5ldyBNYXAoKTtcclxuICAgICAgICB0aGlzLmluaXQoKTtcclxuICAgIH1cclxuICAgIEFwcE1hbm5nZXIuQVBQX0lOREVYID0gMDtcclxuICAgIHJldHVybiBBcHBNYW5uZ2VyO1xyXG59KCkpO1xyXG5leHBvcnRzW1wiZGVmYXVsdFwiXSA9IEFwcE1hbm5nZXI7XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///2\n')},function(module,exports,__webpack_require__){"use strict";eval('\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator["throw"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function sent() {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    "throw": verb(1),\n    "return": verb(2)\n  }, typeof Symbol === "function" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError("Generator is already executing.");\n\n    while (_) {\n      try {\n        if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n        if (y = 0, t) op = [op[0] & 2, t.value];\n\n        switch (op[0]) {\n          case 0:\n          case 1:\n            t = op;\n            break;\n\n          case 4:\n            _.label++;\n            return {\n              value: op[1],\n              done: false\n            };\n\n          case 5:\n            _.label++;\n            y = op[1];\n            op = [0];\n            continue;\n\n          case 7:\n            op = _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n\n          default:\n            if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n              _ = 0;\n              continue;\n            }\n\n            if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n              _.label = op[1];\n              break;\n            }\n\n            if (op[0] === 6 && _.label < t[1]) {\n              _.label = t[1];\n              t = op;\n              break;\n            }\n\n            if (t && _.label < t[2]) {\n              _.label = t[2];\n\n              _.ops.push(op);\n\n              break;\n            }\n\n            if (t[2]) _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n        }\n\n        op = body.call(thisArg, _);\n      } catch (e) {\n        op = [6, e];\n        y = 0;\n      } finally {\n        f = t = 0;\n      }\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n\nexports.__esModule = true;\n\nvar index_1 = __webpack_require__(0);\n\nvar LoadMode;\n\n(function (LoadMode) {\n  LoadMode["js"] = "script";\n  LoadMode["html"] = "html";\n})(LoadMode || (LoadMode = {}));\n\n;\n\nvar getDir = function getDir(path) {\n  var chunks = path.split(\'/\');\n  return chunks.length === 0 ? path : chunks.slice(0, -1).join(\'/\');\n};\n\nfunction uintToString(uintArray) {\n  var encodedString = String.fromCharCode.apply(null, uintArray);\n  return decodeURIComponent(escape(encodedString));\n}\n\nvar AppLoader = function () {\n  function AppLoader(config) {\n    var _this = this;\n\n    this.url = \'\';\n    this.domain = \'\';\n    this.htmlText = \'\';\n    this.script = \'\';\n    this.id = \'\';\n\n    this.runScript = function () {\n      try {\n        _this.jsSandBox.run(_this.script, function () {\n          return _this.mounted();\n        });\n      } catch (e) {\n        console.error(\'加载失败\', e);\n      }\n    };\n\n    this.id = config.id || "Id_" + new Date().getTime().toString(16);\n    this.url = config.url;\n    this.domain = getDir(this.url);\n    this.jsSandBox = new index_1["default"]();\n    this.mode = config.mode;\n    this.parent = config.parent || document.body;\n\n    var defaultLifeCycleFunction = function defaultLifeCycleFunction() {};\n\n    this.beforeLoad = config.beforeLoad || defaultLifeCycleFunction;\n    this.beforeMounted = config.beforeMounted || defaultLifeCycleFunction;\n    this.mounted = config.mounted || defaultLifeCycleFunction;\n    this.beforeDestory = config.beforeDestory || defaultLifeCycleFunction;\n    this.destoryed = config.destoryed || defaultLifeCycleFunction;\n    this.beforeLoad.bind(this);\n    this.beforeDestory.bind(this);\n    this.beforeMounted.bind(this);\n    this.destoryed.bind(this);\n  }\n\n  AppLoader.prototype.load = function (cache) {\n    if (cache === void 0) {\n      cache = false;\n    }\n\n    return __awaiter(this, void 0, void 0, function () {\n      var data;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            this.beforeLoad();\n            data = this.htmlText;\n            if (!!cache) return [3, 2];\n            return [4, this.fetchUrlData(this.url)];\n\n          case 1:\n            data = _a.sent();\n\n            if (typeof data !== \'string\') {\n              console.error("fetch " + this.url + " failed");\n              return [2];\n            }\n\n            this.htmlText = data;\n            _a.label = 2;\n\n          case 2:\n            this.mount();\n            return [2];\n        }\n      });\n    });\n  };\n\n  AppLoader.prototype.mount = function (id) {\n    if (id === void 0) {\n      id = this.id;\n    }\n\n    return __awaiter(this, void 0, void 0, function () {\n      var div_1, srcList_1;\n\n      var _this = this;\n\n      return __generator(this, function (_a) {\n        this.beforeMounted();\n\n        if (this.mode === LoadMode.html) {\n          div_1 = document.createElement(\'div\');\n          div_1.id = id;\n          srcList_1 = [];\n          div_1.innerHTML = this.htmlText;\n          div_1.childNodes.forEach(function (v) {\n            if (v.nodeName === \'SCRIPT\') {\n              var src = v.getAttribute(\'src\');\n\n              if (src !== null) {\n                srcList_1.push(src);\n              } else {\n                _this.script += ";" + v.innerText + ";";\n              }\n            }\n\n            if (v.nodeName === \'META\' || v.nodeName === \'TITLE\') {\n              div_1.removeChild(v);\n            }\n          });\n          this.parent.appendChild(div_1);\n          this.loadScriptList(srcList_1);\n        } else {\n          this.script = this.htmlText || \'\';\n          this.jsSandBox.run(this.script, function () {\n            return _this.mounted();\n          });\n        }\n\n        return [2];\n      });\n    });\n  };\n\n  AppLoader.prototype.destory = function () {\n    this.beforeDestory();\n    var root = document.querySelector(this.id);\n    root.innerHTML = \'\';\n    this.destoryed();\n  };\n\n  AppLoader.prototype.loadScriptList = function (urlArray) {\n    return __awaiter(this, void 0, void 0, function () {\n      var i, data;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            i = 0;\n            _a.label = 1;\n\n          case 1:\n            if (!(i < urlArray.length)) return [3, 4];\n            return [4, this.fetchUrlData(this.domain + \'/\' + urlArray[i])];\n\n          case 2:\n            data = _a.sent();\n\n            if (typeof data !== \'string\') {\n              console.error("fetch " + this.url + " failed");\n              return [2];\n            }\n\n            this.script += data;\n            _a.label = 3;\n\n          case 3:\n            i++;\n            return [3, 1];\n\n          case 4:\n            this.runScript();\n            return [2];\n        }\n      });\n    });\n  };\n\n  AppLoader.prototype.fetchUrlData = function (url) {\n    return new Promise(function (resolve, reject) {\n      fetch(url, {\n        method: \'Get\'\n      }).then(function (res) {\n        res.text().then(function (value) {\n          resolve(value);\n        })["catch"](function (_) {\n          return reject();\n        });\n      })["catch"](function (error) {\n        console.error(error);\n        reject(false);\n      });\n    });\n  };\n\n  return AppLoader;\n}();\n\nexports["default"] = AppLoader;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vaW5kZXgudHM/Yjg1ZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFHQTs7QUFhQSxJQUFLLFFBQUw7O0FBQUEsV0FBSyxRQUFMLEVBQWE7QUFBRztBQUFlO0FBQWUsQ0FBOUMsRUFBSyxRQUFRLEtBQVIsUUFBUSxNQUFiOztBQUE4Qzs7QUFFOUMsSUFBTSxNQUFNLEdBQUcsU0FBVCxNQUFTLENBQUMsSUFBRCxFQUFhO0FBQzFCLE1BQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxLQUFMLENBQVcsR0FBWCxDQUFmO0FBQ0EsU0FBTyxNQUFNLENBQUMsTUFBUCxLQUFrQixDQUFsQixHQUFzQixJQUF0QixHQUE2QixNQUFNLENBQUMsS0FBUCxDQUFhLENBQWIsRUFBZ0IsQ0FBQyxDQUFqQixFQUFvQixJQUFwQixDQUF5QixHQUF6QixDQUFwQztBQUNELENBSEQ7O0FBS0EsU0FBUyxZQUFULENBQXNCLFNBQXRCLEVBQTJDO0FBQ3pDLE1BQU0sYUFBYSxHQUFHLE1BQU0sQ0FBQyxZQUFQLENBQW9CLEtBQXBCLENBQTBCLElBQTFCLEVBQWdDLFNBQWhDLENBQXRCO0FBQ0EsU0FBTyxrQkFBa0IsQ0FBQyxNQUFNLENBQUMsYUFBRCxDQUFQLENBQXpCO0FBQ0Q7O0FBRUQ7QUFnQkUscUJBQVksTUFBWixFQUFpQztBQUFqQzs7QUFmQSxlQUFjLEVBQWQ7QUFDQSxrQkFBaUIsRUFBakI7QUFDQSxvQkFBbUIsRUFBbkI7QUFDQSxrQkFBaUIsRUFBakI7QUFHQSxjQUFhLEVBQWI7O0FBNkdBLHFCQUFZO0FBQ1YsVUFBSTtBQUNGLGFBQUksQ0FBQyxTQUFMLENBQWUsR0FBZixDQUFtQixLQUFJ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QUFKLENBQVksVUFBQyxPQUFELEVBQVUsTUFBVixFQUFnQjtBQUNqQyxXQUFLLENBQUMsR0FBRCxFQUFNO0FBQ1QsY0FBTSxFQUFFO0FBREMsT0FBTixDQUFMLENBR0csSUFISCxDQUdRLGVBQUc7QUFDUCxXQUFHLENBQUMsSUFBSixHQUNHLElBREgsQ0FDUSxpQkFBSztBQUNULGlCQUFPLENBQUMsS0FBRCxDQUFQO0FBQ0QsU0FISCxFQUlHLE9BSkgsRUFJUyxhQUFDO0FBQUk7QUFBUSxTQUp0QjtBQUtELE9BVEgsRUFVRyxPQVZILEVBVVMsVUFBQyxLQUFELEVBQU07QUFDWCxlQUFPLENBQUMsS0FBUixDQUFjLEtBQWQ7QUFDQSxjQUFNLENBQUMsS0FBRCxDQUFOO0FBQ0QsT0FiSDtBQWNELEtBZk0sQ0FBUDtBQWdCRCxHQWpCTzs7QUEwQlY7QUFBQyxDQTNIRCIsImZpbGUiOiIzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XHJcbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufTtcclxudmFyIF9fZ2VuZXJhdG9yID0gKHRoaXMgJiYgdGhpcy5fX2dlbmVyYXRvcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIGJvZHkpIHtcclxuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XHJcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xyXG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcclxuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xyXG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XHJcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxyXG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xyXG4gICAgfVxyXG59O1xyXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xyXG52YXIgaW5kZXhfMSA9IHJlcXVpcmUoXCIuLi9Kc1NhbmRCb3gvaW5kZXhcIik7XHJcbnZhciBMb2FkTW9kZTtcclxuKGZ1bmN0aW9uIChMb2FkTW9kZSkge1xyXG4gICAgTG9hZE1vZGVbXCJqc1wiXSA9IFwic2NyaXB0XCI7XHJcbiAgICBMb2FkTW9kZVtcImh0bWxcIl0gPSBcImh0bWxcIjtcclxufSkoTG9hZE1vZGUgfHwgKExvYWRNb2RlID0ge30pKTtcclxuO1xyXG52YXIgZ2V0RGlyID0gZnVuY3Rpb24gKHBhdGgpIHtcclxuICAgIHZhciBjaHVua3MgPSBwYXRoLnNwbGl0KCcvJyk7XHJcbiAgICByZXR1cm4gY2h1bmtzLmxlbmd0aCA9PT0gMCA/IHBhdGggOiBjaHVua3Muc2xpY2UoMCwgLTEpLmpvaW4oJy8nKTtcclxufTtcclxuZnVuY3Rpb24gdWludFRvU3RyaW5nKHVpbnRBcnJheSkge1xyXG4gICAgdmFyIGVuY29kZWRTdHJpbmcgPSBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsIHVpbnRBcnJheSk7XHJcbiAgICByZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KGVzY2FwZShlbmNvZGVkU3RyaW5nKSk7XHJcbn1cclxudmFyIEFwcExvYWRlciA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBBcHBMb2FkZXIoY29uZmlnKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLnVybCA9ICcnO1xyXG4gICAgICAgIHRoaXMuZG9tYWluID0gJyc7XHJcbiAgICAgICAgdGhpcy5odG1sVGV4dCA9ICcnO1xyXG4gICAgICAgIHRoaXMuc2NyaXB0ID0gJyc7XHJcbiAgICAgICAgdGhpcy5pZCA9ICcnO1xyXG4gICAgICAgIHRoaXMucnVuU2NyaXB0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuanNTYW5kQm94LnJ1bihfdGhpcy5zY3JpcHQsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLm1vdW50ZWQoKTsgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+WKoOi9veWksei0pScsIGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmlkID0gY29uZmlnLmlkIHx8IFwiSWRfXCIgKyBuZXcgRGF0ZSgpLmdldFRpbWUoKS50b1N0cmluZygxNik7XHJcbiAgICAgICAgdGhpcy51cmwgPSBjb25maWcudXJsO1xyXG4gICAgICAgIHRoaXMuZG9tYWluID0gZ2V0RGlyKHRoaXMudXJsKTtcclxuICAgICAgICB0aGlzLmpzU2FuZEJveCA9IG5ldyBpbmRleF8xW1wiZGVmYXVsdFwiXSgpO1xyXG4gICAgICAgIHRoaXMubW9kZSA9IGNvbmZpZy5tb2RlO1xyXG4gICAgICAgIHRoaXMucGFyZW50ID0gY29uZmlnLnBhcmVudCB8fCBkb2N1bWVudC5ib2R5O1xyXG4gICAgICAgIHZhciBkZWZhdWx0TGlmZUN5Y2xlRnVuY3Rpb24gPSBmdW5jdGlvbiAoKSB7IH07XHJcbiAgICAgICAgdGhpcy5iZWZvcmVMb2FkID0gY29uZmlnLmJlZm9yZUxvYWQgfHwgZGVmYXVsdExpZmVDeWNsZUZ1bmN0aW9uO1xyXG4gICAgICAgIHRoaXMuYmVmb3JlTW91bnRlZCA9IGNvbmZpZy5iZWZvcmVNb3VudGVkIHx8IGRlZmF1bHRMaWZlQ3ljbGVGdW5jdGlvbjtcclxuICAgICAgICB0aGlzLm1vdW50ZWQgPSBjb25maWcubW91bnRlZCB8fCBkZWZhdWx0TGlmZUN5Y2xlRnVuY3Rpb247XHJcbiAgICAgICAgdGhpcy5iZWZvcmVEZXN0b3J5ID0gY29uZmlnLmJlZm9yZURlc3RvcnkgfHwgZGVmYXVsdExpZmVDeWNsZUZ1bmN0aW9uO1xyXG4gICAgICAgIHRoaXMuZGVzdG9yeWVkID0gY29uZmlnLmRlc3RvcnllZCB8fCBkZWZhdWx0TGlmZUN5Y2xlRnVuY3Rpb247XHJcbiAgICAgICAgdGhpcy5iZWZvcmVMb2FkLmJpbmQodGhpcyk7XHJcbiAgICAgICAgdGhpcy5iZWZvcmVEZXN0b3J5LmJpbmQodGhpcyk7XHJcbiAgICAgICAgdGhpcy5iZWZvcmVNb3VudGVkLmJpbmQodGhpcyk7XHJcbiAgICAgICAgdGhpcy5kZXN0b3J5ZWQuYmluZCh0aGlzKTtcclxuICAgIH1cclxuICAgIEFwcExvYWRlci5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uIChjYWNoZSkge1xyXG4gICAgICAgIGlmIChjYWNoZSA9PT0gdm9pZCAwKSB7IGNhY2hlID0gZmFsc2U7IH1cclxuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRhO1xyXG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJlZm9yZUxvYWQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHRoaXMuaHRtbFRleHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIWNhY2hlKSByZXR1cm4gWzMsIDJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQsIHRoaXMuZmV0Y2hVcmxEYXRhKHRoaXMudXJsKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGRhdGEgIT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiZmV0Y2ggXCIgKyB0aGlzLnVybCArIFwiIGZhaWxlZFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5odG1sVGV4dCA9IGRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMjtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubW91bnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgQXBwTG9hZGVyLnByb3RvdHlwZS5tb3VudCA9IGZ1bmN0aW9uIChpZCkge1xyXG4gICAgICAgIGlmIChpZCA9PT0gdm9pZCAwKSB7IGlkID0gdGhpcy5pZDsgfVxyXG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGRpdl8xLCBzcmNMaXN0XzE7XHJcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYmVmb3JlTW91bnRlZCgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubW9kZSA9PT0gTG9hZE1vZGUuaHRtbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRpdl8xID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgZGl2XzEuaWQgPSBpZDtcclxuICAgICAgICAgICAgICAgICAgICBzcmNMaXN0XzEgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICBkaXZfMS5pbm5lckhUTUwgPSB0aGlzLmh0bWxUZXh0O1xyXG4gICAgICAgICAgICAgICAgICAgIGRpdl8xLmNoaWxkTm9kZXMuZm9yRWFjaChmdW5jdGlvbiAodikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodi5ub2RlTmFtZSA9PT0gJ1NDUklQVCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzcmMgPSB2LmdldEF0dHJpYnV0ZSgnc3JjJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3JjICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3JjTGlzdF8xLnB1c2goc3JjKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnNjcmlwdCArPSBcIjtcIiArIHYuaW5uZXJUZXh0ICsgXCI7XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHYubm9kZU5hbWUgPT09ICdNRVRBJyB8fCB2Lm5vZGVOYW1lID09PSAnVElUTEUnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXZfMS5yZW1vdmVDaGlsZCh2KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmFwcGVuZENoaWxkKGRpdl8xKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRTY3JpcHRMaXN0KHNyY0xpc3RfMSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjcmlwdCA9IHRoaXMuaHRtbFRleHQgfHwgJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5qc1NhbmRCb3gucnVuKHRoaXMuc2NyaXB0LCBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5tb3VudGVkKCk7IH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyXTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgQXBwTG9hZGVyLnByb3RvdHlwZS5kZXN0b3J5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuYmVmb3JlRGVzdG9yeSgpO1xyXG4gICAgICAgIHZhciByb290ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLmlkKTtcclxuICAgICAgICByb290LmlubmVySFRNTCA9ICcnO1xyXG4gICAgICAgIHRoaXMuZGVzdG9yeWVkKCk7XHJcbiAgICB9O1xyXG4gICAgQXBwTG9hZGVyLnByb3RvdHlwZS5sb2FkU2NyaXB0TGlzdCA9IGZ1bmN0aW9uICh1cmxBcnJheSkge1xyXG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGksIGRhdGE7XHJcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShpIDwgdXJsQXJyYXkubGVuZ3RoKSkgcmV0dXJuIFszLCA0XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0LCB0aGlzLmZldGNoVXJsRGF0YSh0aGlzLmRvbWFpbiArICcvJyArIHVybEFycmF5W2ldKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGRhdGEgIT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiZmV0Y2ggXCIgKyB0aGlzLnVybCArIFwiIGZhaWxlZFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zY3JpcHQgKz0gZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAzO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaSsrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMsIDFdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ydW5TY3JpcHQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgQXBwTG9hZGVyLnByb3RvdHlwZS5mZXRjaFVybERhdGEgPSBmdW5jdGlvbiAodXJsKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgZmV0Y2godXJsLCB7XHJcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdHZXQnXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzKSB7XHJcbiAgICAgICAgICAgICAgICByZXMudGV4dCgpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9KVtcImNhdGNoXCJdKGZ1bmN0aW9uIChfKSB7IHJldHVybiByZWplY3QoKTsgfSk7XHJcbiAgICAgICAgICAgIH0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICAgICAgICAgICAgICAgIHJlamVjdChmYWxzZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBBcHBMb2FkZXI7XHJcbn0oKSk7XHJcbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gQXBwTG9hZGVyO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///3\n')},function(module,exports,__webpack_require__){"use strict";eval("\n\nexports.__esModule = true;\n\nvar ChannelNode = function () {\n  function ChannelNode() {\n    this.callbackList = [];\n    this.childChannel = new Map();\n  }\n\n  ChannelNode.prototype.add = function (cb) {\n    var result = false;\n\n    if (typeof cb === 'function') {\n      this.callbackList.push(cb);\n      result = true;\n    }\n\n    return result;\n  };\n\n  ChannelNode.prototype.remove = function (cb) {\n    var result = false;\n    var oldIndex = this.callbackList.indexOf(cb);\n\n    if (oldIndex > -1) {\n      this.callbackList.splice(oldIndex, 1);\n      result = true;\n    }\n\n    return result;\n  };\n\n  ChannelNode.prototype.addChild = function (name, child) {\n    if (child === void 0) {\n      child = new ChannelNode();\n    }\n\n    if (typeof name !== 'string') {\n      console.error(new TypeError('name is not a string'));\n      return false;\n    }\n\n    if (!(child instanceof ChannelNode)) {\n      console.error(new TypeError('child is not a ChannelNode'));\n      return false;\n    }\n\n    if (this.hasChild(name)) {\n      console.error(new Error('this child node has been added'));\n      return false;\n    }\n\n    this.childChannel.set(name, child);\n    return true;\n  };\n\n  ChannelNode.prototype.hasChild = function (name) {\n    return this.childChannel.has(name);\n  };\n\n  ChannelNode.prototype.getChild = function (name) {\n    return this.childChannel.get(name);\n  };\n\n  ChannelNode.prototype.run = function (payload) {\n    this.callbackList.forEach(function (fn) {\n      fn(payload);\n    });\n  };\n\n  return ChannelNode;\n}();\n\nvar Communicator = function () {\n  function Communicator() {}\n\n  Communicator.prototype.on = function (channel, cb) {\n    var curChannelNode = Communicator.ChannelRoot;\n\n    if (typeof channel !== 'string') {\n      console.error(new TypeError('channel is not a string'));\n      return;\n    }\n\n    var channelList = channel.split(':');\n    channelList.forEach(function (v) {\n      if (!curChannelNode.hasChild(v)) {\n        curChannelNode.addChild(v);\n      }\n\n      curChannelNode = curChannelNode.getChild(v);\n    });\n    curChannelNode.add(cb);\n  };\n\n  Communicator.prototype.emit = function (channel, payload) {\n    if (typeof channel !== 'string') {\n      console.error(new TypeError('channel is not a string'));\n    }\n\n    var channelList = channel.split(':');\n    var curChannelNode = Communicator.ChannelRoot;\n    var isAll = false;\n\n    for (var i = 0; i < channelList.length; i++) {\n      var item = channelList[i];\n\n      if (item === '*') {\n        isAll = true;\n        break;\n      }\n\n      if (curChannelNode.hasChild(item)) {\n        curChannelNode = curChannelNode.getChild(item);\n      } else {\n        curChannelNode = null;\n        break;\n      }\n    }\n\n    if (curChannelNode) {\n      if (isAll) {\n        curChannelNode.childChannel.forEach(function (node) {\n          node.run(payload);\n        });\n      } else {\n        curChannelNode.run(payload);\n      }\n    }\n  };\n\n  Communicator.ChannelRoot = new ChannelNode();\n  return Communicator;\n}();\n\nfunction singleMode(constructor) {\n  var foo = null;\n\n  var fn = function fn() {\n    if (!foo) {\n      foo = Object.create(constructor.prototype);\n      constructor.call(foo);\n    }\n\n    return foo;\n  };\n\n  return fn;\n}\n\nexports[\"default\"] = singleMode(Communicator);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vaW5kZXgudHM/Yjg1ZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBS0E7QUFJRTtBQUNFLFNBQUssWUFBTCxHQUFvQixFQUFwQjtBQUNBLFNBQUssWUFBTCxHQUFvQixJQUFJLEdBQUosRUFBcEI7QUFDRDs7QUFHRCx3Q0FBSSxFQUFKLEVBQWdCO0FBQ2QsUUFBSSxNQUFNLEdBQUcsS0FBYjs7QUFDQSxRQUFJLE9BQU8sRUFBUCxLQUFjLFVBQWxCLEVBQThCO0FBQzVCLFdBQUssWUFBTCxDQUFrQixJQUFsQixDQUF1QixFQUF2QjtBQUNBLFlBQU0sR0FBRyxJQUFUO0FBQ0Q7O0FBQ0QsV0FBTyxNQUFQO0FBQ0QsR0FQRDs7QUFVQSwyQ0FBTyxFQUFQLEVBQW1CO0FBQ2pCLFFBQUksTUFBTSxHQUFHLEtBQWI7QUFDQSxRQUFNLFFBQVEsR0FBRyxLQUFLLFlBQUwsQ0FBa0IsT0FBbEIsQ0FBMEIsRUFBMUIsQ0FBakI7O0FBQ0EsUUFBSSxRQUFRLEdBQUcsQ0FBQyxDQUFoQixFQUFtQjtBQUNqQixXQUFLLFlBQUwsQ0FBa0IsTUFBbEIsQ0FBeUIsUUFBekIsRUFBbUMsQ0FBbkM7QUFDQSxZQUFNLEdBQUcsSUFBVDtBQUNEOztBQUNELFdBQU8sTUFBUDtBQUNELEdBUkQ7O0FBV0EsNkNBQVMsSUFBVCxFQUF1QixLQUF2QixFQUE2RDtBQUF0QztBQUFBLGtCQUF5QixXQUF6QjtBQUFzQzs7QUFDM0QsUUFBSSxPQUFPLElBQVAsS0FBZ0IsUUFBcEIsRUFBOEI7QUFDNUIsYUFBTyxDQUFDLEtBQVIsQ0FBYyxJQUFJLFNBQUosQ0FBYyxzQkFBZCxDQUFkO0FBQ0EsYUFBTyxLQUFQO0FBQ0Q7O0FBQ0QsUUFBSSxFQUFFLEtBQUssWUFBWSxXQUFuQixDQUFKLEVBQXFDO0FBQ25DLGFBQU8sQ0FBQyxLQUFSLENBQWMsSUFBSSxTQUFKLENBQWMsNEJBQWQsQ0FBZDtBQUNBLGFBQU8sS0FBUDtBQUNEOztBQUNELFFBQUksS0FBSyxRQUFMLENB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QyxNQUFJLEdBQUcsR0FBUSxJQUFmOztBQUNBLE1BQU0sRUFBRSxHQUFHLFNBQUwsRUFBSztBQUNULFFBQUksQ0FBQyxHQUFMLEVBQVU7QUFDUixTQUFHLEdBQUcsTUFBTSxDQUFDLE1BQVAsQ0FBYyxXQUFXLENBQUMsU0FBMUIsQ0FBTjtBQUNBLGlCQUFXLENBQUMsSUFBWixDQUFpQixHQUFqQjtBQUNEOztBQUNELFdBQU8sR0FBUDtBQUNELEdBTkQ7O0FBT0EsU0FBTyxFQUFQO0FBQ0Q7O0FBRUQscUJBQWUsVUFBVSxDQUFDLFlBQUQsQ0FBekIiLCJmaWxlIjoiNC5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xyXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xyXG52YXIgQ2hhbm5lbE5vZGUgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQ2hhbm5lbE5vZGUoKSB7XHJcbiAgICAgICAgdGhpcy5jYWxsYmFja0xpc3QgPSBbXTtcclxuICAgICAgICB0aGlzLmNoaWxkQ2hhbm5lbCA9IG5ldyBNYXAoKTtcclxuICAgIH1cclxuICAgIENoYW5uZWxOb2RlLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAoY2IpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gZmFsc2U7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBjYiA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICB0aGlzLmNhbGxiYWNrTGlzdC5wdXNoKGNiKTtcclxuICAgICAgICAgICAgcmVzdWx0ID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH07XHJcbiAgICBDaGFubmVsTm9kZS5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKGNiKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IGZhbHNlO1xyXG4gICAgICAgIHZhciBvbGRJbmRleCA9IHRoaXMuY2FsbGJhY2tMaXN0LmluZGV4T2YoY2IpO1xyXG4gICAgICAgIGlmIChvbGRJbmRleCA+IC0xKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tMaXN0LnNwbGljZShvbGRJbmRleCwgMSk7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9O1xyXG4gICAgQ2hhbm5lbE5vZGUucHJvdG90eXBlLmFkZENoaWxkID0gZnVuY3Rpb24gKG5hbWUsIGNoaWxkKSB7XHJcbiAgICAgICAgaWYgKGNoaWxkID09PSB2b2lkIDApIHsgY2hpbGQgPSBuZXcgQ2hhbm5lbE5vZGUoKTsgfVxyXG4gICAgICAgIGlmICh0eXBlb2YgbmFtZSAhPT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihuZXcgVHlwZUVycm9yKCduYW1lIGlzIG5vdCBhIHN0cmluZycpKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIShjaGlsZCBpbnN0YW5jZW9mIENoYW5uZWxOb2RlKSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKG5ldyBUeXBlRXJyb3IoJ2NoaWxkIGlzIG5vdCBhIENoYW5uZWxOb2RlJykpO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmhhc0NoaWxkKG5hbWUpKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IobmV3IEVycm9yKCd0aGlzIGNoaWxkIG5vZGUgaGFzIGJlZW4gYWRkZWQnKSk7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jaGlsZENoYW5uZWwuc2V0KG5hbWUsIGNoaWxkKTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH07XHJcbiAgICBDaGFubmVsTm9kZS5wcm90b3R5cGUuaGFzQ2hpbGQgPSBmdW5jdGlvbiAobmFtZSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNoaWxkQ2hhbm5lbC5oYXMobmFtZSk7XHJcbiAgICB9O1xyXG4gICAgQ2hhbm5lbE5vZGUucHJvdG90eXBlLmdldENoaWxkID0gZnVuY3Rpb24gKG5hbWUpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jaGlsZENoYW5uZWwuZ2V0KG5hbWUpO1xyXG4gICAgfTtcclxuICAgIENoYW5uZWxOb2RlLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAocGF5bG9hZCkge1xyXG4gICAgICAgIHRoaXMuY2FsbGJhY2tMaXN0LmZvckVhY2goZnVuY3Rpb24gKGZuKSB7XHJcbiAgICAgICAgICAgIGZuKHBheWxvYWQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBDaGFubmVsTm9kZTtcclxufSgpKTtcclxudmFyIENvbW11bmljYXRvciA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBDb21tdW5pY2F0b3IoKSB7XHJcbiAgICB9XHJcbiAgICBDb21tdW5pY2F0b3IucHJvdG90eXBlLm9uID0gZnVuY3Rpb24gKGNoYW5uZWwsIGNiKSB7XHJcbiAgICAgICAgdmFyIGN1ckNoYW5uZWxOb2RlID0gQ29tbXVuaWNhdG9yLkNoYW5uZWxSb290O1xyXG4gICAgICAgIGlmICh0eXBlb2YgY2hhbm5lbCAhPT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihuZXcgVHlwZUVycm9yKCdjaGFubmVsIGlzIG5vdCBhIHN0cmluZycpKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgY2hhbm5lbExpc3QgPSBjaGFubmVsLnNwbGl0KCc6Jyk7XHJcbiAgICAgICAgY2hhbm5lbExpc3QuZm9yRWFjaChmdW5jdGlvbiAodikge1xyXG4gICAgICAgICAgICBpZiAoIWN1ckNoYW5uZWxOb2RlLmhhc0NoaWxkKHYpKSB7XHJcbiAgICAgICAgICAgICAgICBjdXJDaGFubmVsTm9kZS5hZGRDaGlsZCh2KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjdXJDaGFubmVsTm9kZSA9IGN1ckNoYW5uZWxOb2RlLmdldENoaWxkKHYpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGN1ckNoYW5uZWxOb2RlLmFkZChjYik7XHJcbiAgICB9O1xyXG4gICAgQ29tbXVuaWNhdG9yLnByb3RvdHlwZS5lbWl0ID0gZnVuY3Rpb24gKGNoYW5uZWwsIHBheWxvYWQpIHtcclxuICAgICAgICBpZiAodHlwZW9mIGNoYW5uZWwgIT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IobmV3IFR5cGVFcnJvcignY2hhbm5lbCBpcyBub3QgYSBzdHJpbmcnKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBjaGFubmVsTGlzdCA9IGNoYW5uZWwuc3BsaXQoJzonKTtcclxuICAgICAgICB2YXIgY3VyQ2hhbm5lbE5vZGUgPSBDb21tdW5pY2F0b3IuQ2hhbm5lbFJvb3Q7XHJcbiAgICAgICAgdmFyIGlzQWxsID0gZmFsc2U7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGFubmVsTGlzdC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgaXRlbSA9IGNoYW5uZWxMaXN0W2ldO1xyXG4gICAgICAgICAgICBpZiAoaXRlbSA9PT0gJyonKSB7XHJcbiAgICAgICAgICAgICAgICBpc0FsbCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoY3VyQ2hhbm5lbE5vZGUuaGFzQ2hpbGQoaXRlbSkpIHtcclxuICAgICAgICAgICAgICAgIGN1ckNoYW5uZWxOb2RlID0gY3VyQ2hhbm5lbE5vZGUuZ2V0Q2hpbGQoaXRlbSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjdXJDaGFubmVsTm9kZSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY3VyQ2hhbm5lbE5vZGUpIHtcclxuICAgICAgICAgICAgaWYgKGlzQWxsKSB7XHJcbiAgICAgICAgICAgICAgICBjdXJDaGFubmVsTm9kZS5jaGlsZENoYW5uZWwuZm9yRWFjaChmdW5jdGlvbiAobm9kZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vZGUucnVuKHBheWxvYWQpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjdXJDaGFubmVsTm9kZS5ydW4ocGF5bG9hZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgQ29tbXVuaWNhdG9yLkNoYW5uZWxSb290ID0gbmV3IENoYW5uZWxOb2RlKCk7XHJcbiAgICByZXR1cm4gQ29tbXVuaWNhdG9yO1xyXG59KCkpO1xyXG5mdW5jdGlvbiBzaW5nbGVNb2RlKGNvbnN0cnVjdG9yKSB7XHJcbiAgICB2YXIgZm9vID0gbnVsbDtcclxuICAgIHZhciBmbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoIWZvbykge1xyXG4gICAgICAgICAgICBmb28gPSBPYmplY3QuY3JlYXRlKGNvbnN0cnVjdG9yLnByb3RvdHlwZSk7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yLmNhbGwoZm9vKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZvbztcclxuICAgIH07XHJcbiAgICByZXR1cm4gZm47XHJcbn1cclxuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBzaW5nbGVNb2RlKENvbW11bmljYXRvcik7XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///4\n")}])}));